---
author: "Ver√≥nica Cruz Alonso, Marina Rodes Blanco, Juli√°n Tijerin Trivi√±o y Paloma Ruiz Benito"
date: today
date-format: "DD/MM/YYYY"
toc: true
toc-depth: 5
toc-title: "√çndice"
format:
  html:
    link-external-newwindow: true
    title: D√≠a 1  - Introduccion a la programaci√≥n en R
    subtitle: Introducci√≥n
  gfm: 
    title: "D√≠a 1 - Manejo y visualizaci√≥n de datos en R"
editor: visual
editor_options: 
  chunk_output_type: console
number-sections: true
bibliography: references.bib
---

```         
```

![](images/clipboard-77513458.png)

Paloma Ruiz Benito (paloma.ruizb\@uah), Ver√≥nica Cruz-Alonso (veronica.cruza\@uah), Marina Rodes Blanco (marina.rodesb\@uah.es) y Juli√°n Tijerin Trivi√±o (julian.tijerint\@uah.es) somos investigadores de la Universidad de Alcal√°, en el grupo de Ecolog√≠a y Restauraci√≥n Forestal (<https://portalcientifico.uah.es/grupos/9603/detalle>) y en el Grupo de Investigaci√≥n en Teledetecci√≥n Ambiental (<https://geogra.uah.es/gita/>).

Junto con Julen Astigarraga Urcelay (colaborador y amigo), publicamos los materiales de los curso que impartimos en DatSciR.

Y vosotros **¬øqui√©nes sois?**

LINK ENCUESTA: <https://forms.gle/zmqTKWiwM3qVtJi79>

Ahora os toca presentaros a la clase, para que este curso tambi√©n sirva para conocernos todos un poco mejor.

Es vuestro turno, decirnos:

-   Nombre y apellidos,

-   el √°rea y departamento en el que trabaj√°is,

-   sobre qu√© es vuestra tesis

-   c√≥mo us√°is o plane√°s usar R

-   qu√© esper√°is del curso

-   cualquier otra cosa relevante....

**¬øY qu√© es R y de d√≥nde procede?**

[Un poco de historia de R contada por Jumping Rivers](https://www.jumpingrivers.com/misc/timeline/)

![](images/Rhistory.png){width="594"}

## Presentaci√≥n

En este curso exploraremos los **fundamentos te√≥ricos** y las **aplicaciones pr√°cticas** de la ciencia de datos en R. Combinaremos material preparado con los problemas espec√≠ficos de cada asistente, los cuales ir√°n evolucionando d√≠a a d√≠a. El objetivo principal es que tanto aquellos con conocimientos b√°sicos en ciencia de datos como aquellos con un nivel m√°s avanzado puedan beneficiarse y llevar consigo nuevos aprendizajes al finalizar el curso.

![Modelo de ciencia de datos de Hadley Wickham, Mine √áetinkaya-Rundel y Garrett Grolemund. Traducido de https://r4ds.hadley.nz/intro#fig-ds-diagram](images/datascience.png){#fig-datascience}

En este curso no veremos ning√∫n d√≠a modelizar (ya que hay un curso espec√≠fico programado para ello en junio de este a√±o), pero nos centraremos en la gesti√≥n de datos, visualizaci√≥n, trabajo en equipo y comunicaci√≥n. ¬°Esperamos que os sea de utilidad!

## Estructura del curso

+------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------+
| D√≠as de trabajo              | Contenido                                                                                                                                      |
+==============================+================================================================================================================================================+
| **D√≠a 1.** Introducci√≥n      | Introducci√≥n a la programaci√≥n en R                                                                                                            |
|                              |                                                                                                                                                |
| ¬øQu√© necesitamos?            | Conceptos b√°sicos, tipos de datos, consejos b√°sicos de programaci√≥n, introducci√≥n a tidyverse (filtrar, seleccionar) y definici√≥n de objetivos |
+------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------+
| **D√≠a 2.** Organizando datos | Tidyverse                                                                                                                                      |
|                              |                                                                                                                                                |
| ¬øC√≥mo lo organizamos?        | Importar, transformar, unir y exportar datos                                                                                                   |
|                              |                                                                                                                                                |
|                              | Estructuras de programaci√≥n                                                                                                                    |
+------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------+
| **D√≠a 3.** Visualizaci√≥n     | Introducci√≥n a ggplot2                                                                                                                         |
|                              |                                                                                                                                                |
| ¬øC√≥mo lo mostramos?          | Bases: gr√°ficos por capas unidimensionales y bidimensionales                                                                                   |
|                              |                                                                                                                                                |
|                              | Visualizaci√≥n avanzada: personalizaci√≥n y multipanel                                                                                           |
+------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------+
| **D√≠a 4.** Colaboraci√≥n      | Introducci√≥n y flujo en Git y GitHub                                                                                                           |
|                              |                                                                                                                                                |
| ¬øC√≥mo trabajamos en equipo?  | Trabajos colaborativos                                                                                                                         |
+------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------+

**D√≠a 5**

Informe en quarto donde present√©is un objetivo a conseguir y desgraneis la descripci√≥n de datos, manejo necesario y visualizaci√≥n objetivo a trav√©s de un repositorio de github compartido. Grupos de 2-3 personas.

9:00 a 11:00. Trabajo en grupo, resolver dudas.

11:30 a 14:00. Presentaci√≥n en html generado a trav√©s de quarto de 5-7 minutos.

**Din√°mica del curso**

Cada d√≠a combinaremos teor√≠a con ejercicios. Idealmente, tendremos tiempo para que cada uno trabaje con sus propios datos. Todos los apuntes y ejercicios resueltos estar√°n disponibles en el [repositorio de GitHub del curso](https://github.com/DatSciR/ciencia_datos).

¬°as√≠ aprenderemos entre todos! üòâ

![El proceso de aprendizaje en R, por Allison Horst. https://allisonhorst.com/everything-else](images/e684f0da-13b1-4d00-ab25-37814e79ee1e.png){width="362"}

‚ù§Ô∏èüíú‚ù§Ô∏èüíú En el curso intentaremos dedicar al menos una hora al d√≠a a vuestros trabajos, por lo que deb√©is hacer grupos de dos-tres personas para programar. ‚ù§Ô∏èüíú‚ù§Ô∏èüíú

**Antes de empezar. Estamos de acuerdo con el c√≥digo √©tico y hacemos un ejemplo de este curso**

Lee: <https://www.contributor-covenant.org/adopt/> e informaci√≥n sacada de <https://datasciencebox.org/>

![](images/data-science-box.png)

Usamos mucha bibliograf√≠a distinta para realizar este curso, pero os recomendamos los siguientes recursos:

[![\[\[R for data Science\](https://r4ds.hadley.nz/)\] https://r4ds.hadley.nz/)](images/Wickham_RDataScience.jpg){fig-align="left" width="154"}](https://r4ds.hadley.nz/)

[![\[\[Advance R\](http://adv-r.had.co.nz/)\](http://adv-r.had.co.nz/)](images/Wickham_AdvanceR.png){width="151"}](http://adv-r.had.co.nz/)

# Objetivos d√≠a 1

-   Conceptos b√°sicos de R (üìù)

-   Consejos en la gesti√≥n de datos y programaci√≥n (üßë‚Äçüéì )

-   Tipos de objetos, indexaci√≥n y exploraci√≥n b√°sica de datos con R base vs. Tidyverse

# Conceptos b√°sicos üìù

üéØ **R**: lenguaje de programaci√≥n din√°mico (se interpreta el c√≥digo en el momento que se ejecuta).

### üß© *Ejercicio ¬øEst√°is de acuerdo con las siguientes afirmaciones?*

¬øPod√©is en parejas encontrar aspectos por lo que est√©is de acuerdo o en desacuerdo con cada afirmaci√≥n?

¬øpor qu√© crees que es espacialmente importante usar R (u otro lenguaje de programaci√≥n) en ciencia?

> *R es un lenguaje de programaci√≥n para el an√°lisis estad√≠stico.*

R cumple con los siguientes aspectos:

-   C√≥digo libre (gratuito)

-   Estado del arte

-   Flexible y potente

-   Port√°til y replicable en otras plataformas

-   Ejemplos para ‚Äúcasi‚Äù cualquier an√°lisis

-   Por y para la comunidad

¬øC√≥mo debe ser la Ciencia?

-   La ciencia debe ser gratuita

-   La ciencia debe ser en c√≥digo abierto

-   La ciencia debe ser colaborativa.

-   La ciencia debe ser replicable

> RStudio es lo mismo que R

üéØ **RStudio**: entorno de desarrollo integrado para programar en R (*IDE: Integrated Development Environemnt*). Tiene cuatro zonas diferenciadas:

-   el editor de c√≥digo (scripts abiertos y ventana de c√≥digo),

-   el navegador del espacio de trabajo (con el entorno ‚Äì*environment-* y el historial de comandos)

-   la consola (donde se ejecuta el c√≥digo),

-   el mix de abajo a la derecha (Archivos, Gr√°ficos, Paquetes, Ayuda).

![](images/Rstudio_entorno.png)

üéØ **Objetos**: cualquier elemento almacenado con un nombre espec√≠fico. Pueden ser de muchos tipos: `numeric`, `integer`, `logical`, `data.frame`, `SpatVector`, etc.

El operador ":" genera un grupo de n√∫meros enteros:

```{r}
1:6
c(1, 2, 3, 4, 5, 6)
```

Ahora mismo hemos generado un grupo de seis n√∫mero de enteros, pero no se han guardado en ning√∫n sitio en la memoria del ordenador. Si quieres usar este vector de nuevo, debes guardarlo, creando un objeto en R, para ello debes usar la flecha de asignaci√≥n \<-.

```{r}
mi_vector <- 1:6 #con la flecha de asignaci√≥n lo guardo como un objeto R
mi_vector <- c(1, 2, 3, 4, 5, 6) #pero no lo tengo guardado en mi carpeta
str(mi_vector) #podemos ver la estructura del vector
class(mi_vector)
summary(mi_vector) #y unas estadisticas b√°sicas
```

Un tipo de objeto con el que vamos a trabajar es un data.frame que es una tabla donde las filas son las observaciones y las columnas son las variables. En concreto, todos los d√≠as vamos a trabajar con la tabla de **palmer_penguins**.

![](images/palmer_penguins.png)

+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Los datos de **palmer penguins** fueron recopilados y puestos a disposici√≥n por la Dra. Kristen Gorman y la Estaci√≥n Palmer, LTER de la Ant√°rtida, miembro de la Red de Investigaci√≥n Ecol√≥gica a Largo Plazo. Datos de pinguinos adultos de tres especies diferentes y de tres islas diferentes e incluye informaci¬¥n sonbre tama√±o y sexo. |
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

```{r}
library(palmerpenguins)
library(tidyverse)
data(penguins)
str(penguins) #permite ver la estructura de los datos
glimpse(penguins) #permite ver la estructura de los datos, m√°s organizada
summary(penguins)
```

üéØ **Funciones**: objetos de R que toman un vector de entrada y dan como resultado otro vector haciendo una acci√≥n concreta (funcionalidad espec√≠fica). Son los *bloques de construcci√≥n* fundamentales en cualquier script de R que es un lenguaje funcional.

Las funciones usan argumentos, y generalmente tienen elementos de entrada y salida que se transforman de una manera espec√≠fica.

### üß© *Ejercicio ¬øVes alguna funci√≥n especifica en el "chunk" m√°s arriba?*

Los **paquetes o librerias** contienen funciones reutilizables, documentaci√≥n sobre c√≥mo usarlas y datos de ejemplo. Son las unidades fundamentales de c√≥digo reproducible en R. La primera vez que necesitas un paquete o librer√≠a lo instalas, la segunda lo cargas en tu sesi√≥n de trabajo, con las funciones `install.packages()`, `library()`.

> Para comprender la programaci√≥n en R, resultan √∫tiles dos lemas:
>
> \- Todo lo que existe es un objeto.
>
> \- Todo lo que sucede es una llamada a funci√≥n.
>
> ‚Äî John Chambers ([Advanced R](https://adv-r.hadley.nz/index.html))

üéØ **CRAN**: the Comprehensive R Archive Network.

## Consejos para la gesti√≥n de datos y programaci√≥n

Puedes ver y ahondar en los consejos de programaci√≥n en [ESTE](https://revistaecosistemas.net/index.php/ecosistemas/article/view/2129/1336) art√≠culo publicado en la revista ECOSISTEMAS.

### Consejo 1: Trabaja siempre por proyectos e instala los paquetes necesarios

El directorio de trabajo es la carpeta de nuestro ordenador donde estamos trabajando. El script es el archivo b√°sico que almacena c√≥digo de R de nuestra sesi√≥n de trabajo.

``` r
getwd() # saber directorio de trabajo 
setwd("C:/Users/uah/OneDrive - Universidad de Alcala/GitHub_Projects/ciencia_datos_uah") # ojo con la ruta / o \\
```

‚ÑπÔ∏è **Informaci√≥n importante:** Cuando ejecutes un comando en RStudio, recuerda que el resultado aparece inmediatamente en la consola.

No es recomendable establecer el directorio de trabajo manualmente porque el trabajo deja de ser reproducible. Es mejor crear desde el principio un **proyecto en R** ligado a un directorio relativo que contenga todos los datos de entrada, los scripts y los resultados del script. Al abrir el proyecto, se sincroniza con pesta√±a Files.

üí°Para crear un proyecto: Archivo \> Nuevo proyecto.

Es muy importante ENTENDER las ventajas de trabajar por proyectos, [aqu√≠](https://support.posit.co/hc/en-us/articles/200526207-Using-RStudio-Projects) pod√©is ver m√°s informaci√≥n.

Cuando trabajes en R revisa la **configuraci√≥n del c√≥digo** en optiones globales. En el "c√≥digo" las secciones de "1.3.1 Edici√≥n, 1.3.2 Visualizaci√≥n, 1.3.3 Guardado, 1.3.4 Autocompletado , y 1.3.5 Diagn√≥sticos" pueden ser relevantes.

Idealmente **todos los archivos de trabajo** deben estar en la misma carpeta dividiendo datos, analisis, resultados, etc. (aunque el jueves veremos algunas excepciones). Los datos con los que trabajamos deben estar adecuadamente documentados (metadatos, con una descripci√≥n de variables y unidades, autor√≠a, etc.) y debemos conocer las relaciones entre las tablas con las que trabajamos (bases de datos relacionales).

### üß© *Ejercicio*

Crea un proyecto para el Curso: **proyecto_doctorado_UAH_R** y un proyecto del cuaderno de clase **cuaderno_doctorado_UAH_R.** Una vez creado genera una carpeta de "scripts" y una de "resultados". Revisa en tu panel de Rstudio a la derecha, abajo, que archivos tienes. ¬øC√≥mo has nombrado tu archivo de trabajo actual? ¬°Revisa y cambia el nombre al final de la sesi√≥n!

Normalmente, para trabajar adecuadamente debemos organizar las carpetas y los nombres de los archivos con los que trabajamos ¬øC√≥mo lo hac√©is habitualmente?

``` r
# install.packages("tidyverse", dep = T) # dep = T significa instalar dependencias

library(tidyverse)

install.packages(c("swirl", "swirlify"))
library(swirlify)
```

Adem√°s de un archivo ".README" que explique la organizaci√≥n del trabajo, pod√©is especificar archivos de entrada, salida, scripts o procesos. Todo an√°lisis depende de un conjunto de paquetes que conviene documentar consistentemente, y permite tener todo organizado.

![](images/readme_proyectos_RodriguezSanchez%20et%20al.jpg)

[ESTE](https://revistaecosistemas.net/index.php/ecosistemas/article/view/2129/1336) art√≠culo publicado en la revista ECOSISTEMAS.

### Consejo 2: Usa teclas r√°pidas y comenta tu c√≥digo

*¬°En este curso debes usar las TECLAS R√ÅPIDAS para programar!*

Utiliza **comentarios** para guiar al lector con `#`, acordarte por qu√© hiciste un determinado c√≥digo, o ayudar a otra persona a entender tu c√≥digo sin necesitar que tu se lo expliques (o a ti mismo dentro de un tiempo...) ¬°un c√≥digo buen comentado te ahorrar√° mucho tiempo! Adem√°s, te aconsejamos usar un **c√≥digo modular**, partiendo un script en varios peque√±os o escribiendo funciones con un cometido espec√≠fico (evitando repeticiones de c√≥digo).

üí° Para ejecutar una l√≠nea de c√≥digo usa el comando: *Ctrl + Enter (Ctrl + R)*

*¬°No tienes que seleccionar con el rat√≥n la l√≠nea de ejecutar y darle a "Run"! con las techas de m√°s arriba e incluso shift te ahorrara tiempo!*

+--------------------+------------------------------------------------------------------------------------------+
| Atajo              | Efecto                                                                                   |
+====================+==========================================================================================+
| Ctrl + Z           | Deshacer                                                                                 |
+--------------------+------------------------------------------------------------------------------------------+
| Ctrl + Shift + Z   | Rehacer (no es la convenci√≥n habitual)                                                   |
+--------------------+------------------------------------------------------------------------------------------+
| Ctrl + O           | Abrir archivo                                                                            |
+--------------------+------------------------------------------------------------------------------------------+
| Ctrl + A           | Seleccionar todo                                                                         |
+--------------------+------------------------------------------------------------------------------------------+
| Ctrl + S           | Guardar archivo                                                                          |
+--------------------+------------------------------------------------------------------------------------------+
| Ctrl + F           | Buscar en el archivo actual                                                              |
+--------------------+------------------------------------------------------------------------------------------+
| Ctrl + Shift + F   | Buscar en varios archivos                                                                |
+--------------------+------------------------------------------------------------------------------------------+
| Ctrl + W           | Cerrar pesta√±a                                                                           |
+--------------------+------------------------------------------------------------------------------------------+
| Ctrl + Tab         | Ir a la siguiente pesta√±a                                                                |
+--------------------+------------------------------------------------------------------------------------------+
| Ctrl + Q           | Salir de RStudio                                                                         |
+--------------------+------------------------------------------------------------------------------------------+
| Tab                | Indentar / Autocompletado                                                                |
+--------------------+------------------------------------------------------------------------------------------+
| Shift + Tab        | Quitar indentaci√≥n                                                                       |
+--------------------+------------------------------------------------------------------------------------------+
| Ctrl + Shift + F10 | Reiniciar la sesi√≥n de R (¬°conviene hacerlo a menudo!)                                   |
+--------------------+------------------------------------------------------------------------------------------+
| Ctrl + Shift + H   | Elegir directorio de trabajo (no necesario si trabajas en un proyecto de R üòâ)           |
+--------------------+------------------------------------------------------------------------------------------+
| Ctrl + F7          | A√±adir una nueva columna de c√≥digo (se elimina cerrando todas sus pesta√±as con Ctrl + W) |
+--------------------+------------------------------------------------------------------------------------------+

### Consejo 3: Aprende a pedir ayuda, conoce las funciones y argumentos

Dentro de los paquetes puedes pedir ayuda de multiples maneras.

### üß© *Ejercicio*

¬øpuedes buscar ayuda sobre qu√© es el paquete tidyverse y qu√© hace? ¬øpuedes buscar ayuda sobre la funci√≥n "select"?

``` r
?tidyverse
```

``` r
?select
```

En [este](https://www.revistaecosistemas.net/index.php/ecosistemas/article/view/1880/1242)trabajo puedes leer "por qu√© escribir funciones en R", y la respuesta es sencilla: proque todo se basa en funciones en R. Cuando trabajes con una funci√≥n debes comprender sus argumentos (elementros de entrada de la funci√≥n), el funcionamiento (qu√© hace la funci√≥n) y la salida.

### Consejo 4: Mant√©n el c√≥digo reproducible

![[The Reproducibility process](https://the-turing-way.netlify.app/reproducible-research/overview/overview-definitions.html#rr-overview-definitions). [The Turing Way Community (2025)](https://doi.org/10.5281/ZENODO.3233853).](images/evolution-openscien.png)

### üß© *Ejercicio*

Aprende sobre reproducibilidad, ya que es clave y fundamental en ciencia. Lee el [siguiente](https://book.the-turing-way.org/reproducible-research/overview/overview-definitions/) enlace (qu√© es la reproducibilidad y por qu√© debe usarse) y discute

-   ¬øes realmente todo lo que haces reproducible? ¬øhaces alg√∫n aspecto del proceso de publicaci√≥n reproducible?

-   ¬øsabes identificar por qu√©?

-   ¬øque ventajas y desventajas tiene hacerlo reproducible?

**Discutelo en parejas.**

¬øes todo lo que hab√©is realmente reproducible?

![](images/flujo_trabajo.jpg)

![](images/reproducibility_spectrum.jpg)

Aqu√≠ os dejamos algunas de las ventajas de la reproducibildiad y porqu√© debe implementarse en los equipos de trabajo.

![Ventajas de la reproducibilidad. The Turing Way Community (2025).](images/reasons-reproducibil.png)

Ver [este](https://www.youtube.com/watch?v=s3JldKoA0zw)video de EcoInform√°tica.

### Consejo 5: Nombra objetos y archivos adecuadamente

![](images/Importance-style-guide.png)

### Nombrar objetos y archivos

Al asignar un nombre a un objeto podemos llamarlos siempre que necesitemos a lo largo del script. No es necesario guardar (exportar) la mayor√≠a de los objetos que tenemos en el entorno de trabajo de R a nuestro ordenador, lo importante es conservar el script con el que se generan.

### üß© *Ejercicio*

¬øEs lo mismo nombrar a un objeto "x" o "X"?¬øCrees que te puede dar problemas en el c√≥digo nombrar variables con may√∫sculas y min√∫sculas? Para verlo, nombra dos objetos

```{r}
x <- 4.5 
X <- "objeto" # si el objeto contiene letras, usar comillas 
class(x) # funci√≥n para ver de que clase es nuestro objeto 
```

üìùR es sensible a las may√∫sculas. Mejor no usarlas.

üìùLos nombre de los objetos deben ser **descriptivos** y no deben contener s√≠mbolos especiales. Es mejor usar nombres largos pero descriptivos, que cortos o sin sentido.

üí° Excepci√≥n: para archivos temporales yo generalmente uso "kk" que me recuerda a recordar que este archivo es temporal y prescindible...

![](images/FINALdoc.png)

> Hay dos cosas dif√≠ciles en la Ciencia de Computaci√≥n:
>
> \- Invalidar cach√©s.
>
> \- Poner nombres a cosas
>
> ‚Äî Phil Carton

üìùUsa nombre memorables y correctos para tus variables:

-   ‚úÖ Siempre empiezan por letras (en el caso de objetos)

-   ‚úÖ Solo pueden contener letras, numeros, "\_" y ".".

-   ‚úÖ Los nombres deben ser legibles por m√°quinas: No uses espacios, caracteres especiales o palabras reservadas.: (`^`, `!`, `$`, `@`, `+`, `-`, `/`, `*`).

-   ‚úÖ Usa min√∫sculas separadas por "\_"

-   ‚úÖ Los nombres deben ser legibles para humanos: describen lo que continene. Para variables usa nombres y para funciones verbos.

-   ‚úÖ Evita el uso de nombres comunes Object names must start with a letter and can only contain letters, numbers, \_, and ..

üí° Numerar los scripts e incluso las salidas (tablas, figuras, etc.) ayuda a simplificar el orden y trabajar comodamente mediante proyectos.

### üß© *Ejercicio*

Lee la **gu√≠a de estilo** de tidyverse (con la que trabajaremos en el curso):

-   Secci√≥n 2.2.: <https://r4ds.hadley.nz/workflow-style.html>

-   Secci√≥n 4.1. y 4.2.: <https://style.tidyverse.org/syntax.html>

Revisa c√≥mo nombras a las tablas y las variables con las que trabajas:

-   ¬øsiguen un buen estilo a la hora de nombrarlas?

-   ¬øtrabajas en proyectos y tienes todo ordenado adecuadamente?

## Tipos de objetos, exploraci√≥n b√°sica de datos e indexaci√≥n con R base vs. Tidyverse

En R, el c√≥digo que tecleas se llama **comando**. La interfaz de Rstudio es sencilla, cuando en el ***prompt*** de la consola de RStudio ejecutas una l√≠nea de comando da instrucciones al ordenador para hacer la operaci√≥n escrita. Puedes usar R como una calculadora, usando operadores matem√°ticos, relacionales o l√≥gicos, que son:

![](images/Operadores.png)

```{r aritmetica}

5 + 6
5 * 6
60 / 4
5 + 4 - 2
5 + 4 * 5
(5 + 4) * 5
log(10) # logaritmo neperiano 
log10(10) 
exp(1) 
3 ^ 2 
3 ^ 2 / 3 
sqrt(16) 
pi 
sin(pi / 2) # en radianes 
cos(pi / 2)
tan(pi / 2)
asin(1) * 2
acos(1)
```

### Tipos de objetos

üéØ Un **vector** es la estructura de datos m√°s simple en R. Es una colecci√≥n de uno o m√°s elementos del mismo tipo (n√∫meros, texto o valores l√≥gicos).

*¬øQu√© tipos de datos puede contener un vector?*

Si tu dato es numerico, puede ser discreto (int) o continue (num)

![](images/continuous_discrete_allinson) [Imagen de Allson Horst](https://allisonhorst.com/everything-else)

üß† *¬øExiste alg√∫n otro tipo de dato n√∫merico? Busca informaci√≥n sobre otro tipo de dato.*

‚ö†Ô∏è *¬øson todos los tipos de datos categ√≥ricos iguales?*

![](images/nominal_ordinal_Allinson) [Imagen de Allson Horst](https://allisonhorst.com/everything-else)

Sobre los datos num√©ricos, o grupos sobre factor se pueden usar funciones b√°sicas como `mean()`, `min()`, `max()`, adem√°s de poder realizar las operaciones b√°sicas con vectores.

```{r vectores}

vector1 <- c(2.4, 4, 6, 3.2) # si quiero asignar mas de un valor uso "c" (concatenar) 
vector1 
vector1 * 100 # puedo operar con los vectores 
log(vector1)
vector2 <- c(1, 3, 4, 8) # pero tambi√©n entre vectores 
vector1 + vector2
vector3 <- vector1 - vector2 
vector3

mean(x = vector2) # funciones ya programadas 
# ?mean # ayuda de funciones
sd(vector2) 
length(vector2) # n vector 
max(vector2) 
min(vector2)

# funciones que facilitan la creaci√≥n de vectores
rep(x = 1, times = 4) 
1:10 # dos puntos de a a b 
seq(from = 1, to = 20, by = 2) 
c(vector1, vector2) 
c(vector1, rep(0, 3), vector1)
```

Para crear vectores se pueden usar otras estrategias como las que ten√©is recogidas a continuaci√≥n.

```{r mas_vectores}

rep(x = 1, times = 4) 
rep(1:4, times = 2) 
rep(1:4, each = 2) 
rep(1:4, times = 1:4)
rep(x = c("gato", "perro", "pez"), times = c(5, 3, 1))
rnorm(10, mean = 4, sd = 2.2)
```

üéØ Las **matrices** son datos bidimensionales que contienen datos del mismo tipo.

```{r matrices}

mivector <- sample(x = 1:10, size = 1000, replace = T) # sample: funci√≥n para crear numeros aleatorios 

mimatriz <- matrix(mivector, nrow = 100, ncol = 10) # matrix: funci√≥n para convertir vector en matriz. matrix va a rellenar por columnas por defecto

str(mivector) # mostrar estructura datos 
str(mimatriz)

summary(mivector) # resumen de los datos 
summary(mimatriz)

a <- c(1, 2, 3, 4) 
b <- c(1, 2, 3, 4) 
d <- c("hi", "hola", "hola", "hi")

mimatriz_num <- matrix(c(a, b), nrow = 4, ncol = 2) 
mimatriz_num

mimatriz_car <- matrix(c(a, b, d), nrow = 4, ncol = 3) 
mimatriz_car

summary(mimatriz_num) 
summary(mimatriz_car)
```

üéØ Una **lista** puede contener objetos heterog√©neos: vectores, matrices, data.frames, modelos, etc.

```{r listas}

a <- c(1, 2, 3, 4) 
b <- c(1, 2, 3, 4) 
d <- c("hi", "hola", "hola", "hi")
e <- c(TRUE, TRUE, TRUE, FALSE, FALSE)

milista <- list(a, b, d, e)
milista 

str(milista) 
summary(milista)

milista2 <- list(a, b, d, e, mimatriz)
str(milista2)
```

üéØ Un **data.frame** es una tabla (2D) donde cada columna puede ser de distinto tipo. Es la estructura m√°s usada para an√°lisis y la que normalmente acompa√±a a una capa espacial (atributos).

```{r dataframes}

midataframe <- data.frame(
  mivariable1 = a, 
  mivariable2 = b, 
  mivariable3 = d)

View(midataframe)

# un tibble es un data.frame de tidyverse, con caracter√≠sticas mejoradas

mitibble <- tibble(
  mivariable1 = a, 
  mivariable2 = b, 
  mivariable3 = d)

str(mitibble) 
str(midataframe) 

summary(mitibble) 
summary(midataframe) 

mitibble
midataframe
```

### üß© *Ejercicio*

-   Crea un vector usando tu "chuleta" r-base y probando que al menos que tenga una longitud de la base de datos penguins. Puedes usar las opciones: c(), seq(). Genera un vector tipo fecha.
-   Genera un vector tipo factor nominal, ordinal y binario. Puedes usar la funci√≥n tipo rep().
-   Une todos los vectores en un data frame.

### Exploraci√≥n b√°sica de datos

Cuando trabajamos con un data.frame o cualquier otro objeto, lo primero que debemos conocer es su estructura: n√∫mero de observaciones o filas, n√∫mero de columnas o variables, tipo de dato (n√∫merico o car√°cter, y de qu√© tipo).

Lo siguiente que debemos conocer son las caracter√≠sticas b√°sicas ¬øconoces tus datos?. Intenta si puedes reponder a estas preguntas b√°sicas de la variable de inter√©s:

-   ¬ømedidas de centralidad (e.g. media, moda, mediana)?

-   ¬øy medidas de dispersi√≥n (rangos, percentiles, valores an√≥males, desviaci√≥n estandar y error est√°ndar?

-   ¬øvarian por ciertos niveles del factor (e.g. ¬øespecie de ping√ºino?).

-   ¬øTienes ceros o valores nulos entus datos? ¬øPor qu√©?

### üß© *Ejercicio*

Realiza las estad√≠sticas b√°sicas de los datos de **penguins** con summary. Selecciona una variable, por ejemplo, la longitud del pico y genera un nuevo vector donde reemplaces tres datos por valores extremos.

¬øEs la media suficiente para conocer la distribuci√≥n de los datos? ¬øqu√© informaci√≥n te dan los extremos?

¬øQu√© gr√°ficos b√°sicos existen para conocer la centralidad y la variabilidad de los datos? Si hac√©is el curso de estad√≠stica esto lo llamamos Exploraci√≥n B√°sica de Datos y es la base central de caulquier an√°lisis, que requieren de una buena base te√≥rica y una buena exploraci√≥n y conocimiento de los datos.

![](images/summary_statistics)

[Imagen de Allson Horst](https://allisonhorst.com/everything-else)

### Indexaci√≥n y exploraci√≥n b√°sica de datos con Rbase y tidyverse. Uso de la pipa

`Rbase` es el paquete que viene en R por defecto, mientras que `tidyverse` es un conjunto de paquetes de R para ciencia de datos. El n√∫cleo contiene ocho paquetes principales (`readr`, `tibble`, `dplyr`, `tidyr`, `stringr`, `forcats`, `ggplot2` y `purrr`), que comparten el dise√±o, la gram√°tica y la estructura de los datos que necesitan. En el centro de la filosof√≠a de tidyverse se encuentra la noci√≥n de ‚Äúdatos ordenados‚Äù (*tidy data*). Hadley Wickham (principal desarrollador de *tidyverse*) los define como ‚Äúf√°ciles de manipular, modelar y visualizar, y que tienen una estructura espec√≠fica: cada variable es una columna, cada observaci√≥n es una fila y cada valor es una celda‚Äù. *Tidyverse* puede considerarse un dialecto del lenguaje de programaci√≥n R que discretiza funciones amplias de R base (p. ej. `merge`) en diversas funciones espec√≠ficas (p. ej. `left_join`, `right_join`).

![<https://tidyverse.org/>](images/tidyverse_packages.png)

Se basa en los siguientes [principios b√°sicos](https://design.tidyverse.org/unifying.html):

-   **Centrado en humanos**: tiene un dise√±o intuitivo que facilita su uso y accesibilidad para el usuario

> Los programas deben escribirse para que las personas los lean, y solo de manera incidental para que las m√°quinas los ejecuten.
>
> ‚Äî Hal Abelson

-   **Consistencia**: todos los paquetes est√°n dise√±ados para trabajar con datos ordenados (‚ÄúTidy Data‚Äù), y las funciones de los paquetes tienen una nomenclatura com√∫n y congruente. Esto permite que un usuario que aprende sobre una funci√≥n o paquete pueda aplicar ese conocimiento a otros, facilitando as√≠ la tarea de recordar y deducir c√≥digo de manera m√°s sencilla.

> Un sistema debe construirse con un conjunto m√≠nimo de partes inmutables; esas partes deben ser lo m√°s generales posible; y todas las partes del sistema deben mantenerse dentro de un marco uniforme.
>
> ‚Äî Daniel H. H. Ingalls

-   **Componiblidad**: permite al usuario resolver problemas complejos dividi√©ndolos en peque√±as partes, que pueden combinarse utilizando el operador ‚Äúpipe‚Äù (`%>%` or `|>)`.

> Por muy complejas y pulidas que sean las operaciones individuales, a menudo es la calidad del ‚Äúpegamento‚Äù lo que determina de forma m√°s directa el poder del sistema.
>
> ‚Äî Hal Abelson

-   **Inclusividad**: no se trata s√≥lo de la colecci√≥n de paquetes, sino tambi√©n la comunidad de personas que los usan, bas√°ndose en la ayuda entre usuarios y generando un ambiente inclusivo.

### Datos ordenados o tidy data

üí° Cuando trabajamos con datos tipo "data.frame" fila es una *observaci√≥n"* y cada columna es una "*variable*. Esto parece sencillo, pero *¬ørealmente ocurre as√≠?* primero asegurate de la estructura de tus datos, que la comprendes e intenta trabajar con tidy data.

![](images/clipboard-2935155425.png)

Esto facilita el an√°lisis, la manipulaci√≥n y la visualizaci√≥n de datos. Esto lo explican muy bien con una serie de ilustraciones Julia Lowndes y Allison Horst en ["Tidy data for efficiency, reproducibility, and collaboration"](https://openscapes.org/blog/2020-10-12-tidy-data/)

![](images/tidydata_2.png)

Usando este est√°ndar se consigue que todos los set de datos tengan la misma estructura.

![](images/tidydata_3.png)

Trabajar con tidy data es m√°s eficiente, permite la colaboraci√≥n, la reproducibilidad y la reutilizaci√≥n de c√≥digo.

üìù En esta secci√≥n vamos a comparar dos operaciones muy comunes en manipulaci√≥n de datos, adem√°s de hacer estadisticas b√°sicas

-   `select()` para **elegir columnas**\
-   `filter()` para **elegir filas**

Primero veremos c√≥mo se hacen en **base R** y luego con el **tidyverse**. Usaremos el dataset incorporado en R llamado `penguins`,

**Nuestro objetivo:** seleccionar la especie que tiene un mayor peso corporal para los machos. Para lo que:

1.  Conocemos los datos

2.  Seleccionamos variables de inter√©s

3.  Filtramos los machos

4.  Los colocamos en orden descendiente

5.  Mostramos los resultados: nuestro primer gr√°fico

#### 1. Conoce tus datos para una pregunta concreta

```{r}

#### readr (read rectangular data) ####
str(penguins)    
glimpse(penguins)   
head(penguins)      
tail(penguins)      
summary(penguins)  
names(penguins)     
dim(penguins)        
nrow(penguins)       
ncol(penguins)      
```

#### Ejercicio üß©

Piensa y escribe en una l√≠nea qu√© hace cada funci√≥n y discutelo con el compa√±ero. ¬øHay alg√∫n dato extra√±o? ¬øHay que tomar alguna decisi√≥n?

#### 2. Selecci√≥n de variables de inter√©s: Rbase vs. tidyverse

#### Queremos seleccionar las variables `body_mass_g` (peso corporal) y `species` (especie), adem√°s del `sex` (g√©nero).

### Con Base R

```{r}
penguins_rbase1 <- penguins[, c("species", "body_mass_g", "sex")]
penguins_rbase2 <- penguins[, c(1, 6, 7)]
```

### Con tidyverse (`select()`)

```{r}
penguins_tidy <- penguins |>
  select(species, body_mass_g, sex)
```

Para comprender lo que hacemos tenemos que usar la pipa:

![](images/pipa.png)

no hace m√°s que lo siguiente, pero ayuda a mucho a comprender y sintetizar c√≥digo, porque ¬øen qu√© sentido hablamos los humanos?

![](images/funcionamiento_pipa.png)

#### üß© Ejercicio

*Diferencias entre Rbase y tidyverse.* ¬øQu√© es m√°s sencillo de entender? ¬øy m√°s reproducible de las tres opciones que hemos visto?

------------------------------------------------------------------------

#### . Filtramos los machos

Queremos quedarnos solo con los machos

### Con Base R

```{r}
select_penguins_filtrado <- penguins_rbase1[penguins_rbase1$sex == "male", ]
```

### Con tidyverse (`filter()`)

[Filter](https://dplyr.tidyverse.org/reference/filter.html): filtrar filas utilizando condiciones

```{r}
select_penguins_filtrado <- filter(penguins_rbase1, sex == "male")

select_penguins_filtrado <- penguins_rbase1 |>
  filter(sex == "male")
```

------------------------------------------------------------------------

#### 4. Lo colocamos en orden descendiente, combinando operaciones

### Con tidyverse (piping)

```{r}
penguins_male_body_kg <- penguins |>
  select(species, body_mass_g, sex) |>
  filter(sex == "male") |> 
  mutate(body_mass_kg = body_mass_g / 1000)|> 
  arrange(body_mass_kg) 
```

[Arrange](https://dplyr.tidyverse.org/reference/arrange.html): ordenar filas por los valores de una o m√°s variables (columnas)

üëâ Ventajas: m√°s intuitivo, cada paso es claro y en ‚Äúlenguaje natural‚Äù.

üëâ Inconvenientes: requiere instalar/cargar dplyr.

### Con Rbase (piping)

```{r}
#sin pipa
penguins_rbase1 <- penguins[penguins_rbase1$sex == "male", c("species", "body_mass_g", "sex")]
penguins_rbase1$body_mass_kg <- penguins_rbase1$body_mass_g / 1000
penguins_sorted <- penguins_rbase1[order(penguins_rbase1$body_mass_kg), ]


```

üëâ Ventajas: usa solo R base, no necesita librer√≠as adicionales. üëâ Inconvenientes: la sintaxis es m√°s dificil para alumnos principiantes, menos legible.

#### 5. Mostramos los resultados: nuestro primer gr√°fico

Gr√°fico base R

```{r}
plot(penguins_male_body_kg$species, penguins_male_body_kg$body_mass_kg,
     main = "",
     xlab = "species", 
     ylab = "body mass (kg)",
     pch = 19, col = "blue")
```

Gr√°fico con ggplot2, paquete de gr√°ficos de tidyverse

```{r}
ggplot(penguins_male_body_kg, aes(x = species, y = body_mass_kg)) +
  geom_boxplot(color = "darkred", size = 0.5) +
  labs(title = "body mass ~ species (tidyverse)",
       x = "species",
       y = "body mass (kg)") +
  theme_minimal()
```

------------------------------------------------------------------------

#### üß© Ejercicio

Ahora es vuestro turno üí°, practica la seleccion y filtrado con la pipa.

1.  **Ejercicio 1:** Selecciona solo las columnas `bill_length_mm` y `bill_depth_mm` de `penguins` usando tanto base R como tidyverse.\
2.  **Ejercicio 2:** Filtra los individuos que tengan un body_mass_kg mayor de 3,5 . Calcula la media de la longitud y profundidadd del pico.\
3.  **Ejercicio 3 (reto):** Usando tidyverse, selecciona todas las columnas num√©ricas, y qu√©date solo con los individuos de la especie Adelie de sexo femenino. Calcula la media, y rangos (m√≠nimo, m√°ximo).

![](images/R_heart.gif)

#### üß© Trabajos con vuestros datos y proyecto

Piensa en el modelo de ciencia de datos que hemos visto al principio del d√≠a:

![Modelo de ciencia de datos de Hadley Wickham, Mine √áetinkaya-Rundel y Garrett Grolemund. Traducido de https://r4ds.hadley.nz/intro#fig-ds-diagram](images/datascience.png)

**Plantea el objetivo de vuestro trabajo**

-   ¬øqu√© variables us√°is y como son vuestros datos?

-   ¬øpuedes describir el data.frame que impartas y responder a las siguientes preguntas?:

    -   ¬øSon vuestros datos tidy? ¬øQu√© representa cada fila y qu√© cada columna? Especifica el n√∫mero de filas y columnas. Ten claro y documenta c√≥mo has llegado a ello, siempre es recomendable tener unos metadatos con una descripci√≥n de los datos, obtenci√≥n, fuentes y unidades.

    -   ¬øQu√© tipo de datos y caracteristicas tiene cada columna? Revisa para las numericas las medidas de centralidad y de dispersi√≥n: ¬øtienen sentido los valores? ¬øtienes datos anomalos? ¬øtienes muchos ceros o NAs y que significan?

    -   Revisa el tipo de datos tipo caracter que que significan, ¬øson de tipo nominal, ordinal o binario?¬øpuedes comprobar los niveles de las variables seleccionadas?

-   Revisa que tipo de gr√°fico te gustar√≠a visualizar al terminar el curso. Ma√±ana ver√©is las operaciones que pod√©is / ten√©is que realizar para ello, y el mi√©rcoles c√≥mo realizar la visualizaci√≥n, pero es conveneinte que teng√°is una idea de QU√â QUEREIS HACER, y es muy importante saberlo ANTES de programar.

### ¬øQui√©n responde a mis dudas?

-   [RStudio User Guide](https://docs.posit.co/ide/user)

-   [Cheatsheet de buenas pr√°cticas en R](https://rstudio.github.io/cheatsheets/R-best-practice.pdf)

-   [Posit Recipes](https://posit.cloud/learn/recipes) y en general [Posit Resources](https://posit.co/resources)

-   Ayuda \> Cheat Sheets

-   [Stack Overflow: plataforma de preguntas y respuestas para programadores profesionales y aficionados](https://stackoverflow.com)

-   [Comunidad de RStudio/Posit](RStudio%20community)

-   [GitHub copilot](https://github.com/features/copilot)

-   [ChatGPT](https://chatgpt.com) y similares

-   Slack del [Grupo de Ecoinform√°tica de la AEET](https://ecoinfaeet.github.io/website/index.html)

-   [Discusiones del repositorio del curso de GitHub](https://github.com/DatSciR/ciencia_datos/discussions/2)

-   Para dudas relacionadas con errores de paquetes: repositorio de GitHub del paquete en cuesti√≥n (p. ej. <https://github.com/tidyverse/dplyr/issues>)

-   Pedir ayuda utilizando ejemplos reproducibles con {[reprex](#0)}.

![Por Allison Horst. <https://allisonhorst.com/everything-else>](images/rhelpers.png){width="538"}
