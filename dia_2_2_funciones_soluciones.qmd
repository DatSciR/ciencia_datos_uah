---
title: "D√≠a 2 - Manejo de datos con Tidyverse. Programa de doctorado UAH"
author: "Marina Rodes Blanco, Paloma Ruiz Benito, Ver√≥nica Cruz Alonso y Juli√°n Tijerin Trivi√±o"
date: today
date-format: "DD/MM/YYYY"
toc: true
toc-depth: 5
toc-title: "√çndice"
format:
  html:
    link-external-newwindow: true
    # css: styles.css
  gfm: default
editor: visual
editor_options: 
  chunk_output_type: console
number-sections: true
---

## Introducci√≥n a la programaci√≥n con funciones

#### üß© Ejercicio 1: consultar la funci√≥n matrix()

Consulta la ayuda de la funci√≥n matrix. ¬øCuantos argumentos tiene?. Genera una matriz con esta funcion usando todos los argumentos.

```{r}

? matrix

# argumentos: 
  # data: data vector 
  # nrow: number of rows
  # ncol: number of columns
  # byrow: if the matrix is filled by columns or by rows
  # dimnames:  NULL or a list of length 2 giving the row and column names respectively. 

matrix(1:10,
       nrow=5,
       ncol=2,
       byrow=TRUE, 
       dimnames=list(c("r1","r2","r3","r4","r5"),
                     c("c1","c2")))
```

## C√≥mo escribir una funci√≥n

### üß© Ejercicio 2: consultar la funci√≥n sort()

-   Ordena el vector c(5, 8, 6, 2, 4, 5, NA) usando la funcion sort()

-   Utiliza el argumento "decreasing" para ordenarlo de mayor a menor (consulta la ayuda para ver como se usa este argumento). ¬øQu√© valor tiene por defecto?

-   ¬øQue otro argumento tiene la funcion que especifica detalles de la ejecuci√≥n? C√°mbialo a otro valor que no sea su valor por defecto.

-   ¬øCual es el valor de retorno de la funci√≥n?

```{r}

# nombro el vector
v1<-  c(5, 8, 6, 2, 4, 5, NA)

# lo ordeno usando sort
sort(v1)

# de mayor a menor
sort(v1, decreasing=TRUE) #cambio el valor por defecto (FALSE) a TRUE

# argumento na.last
sort(v1, decreasing=TRUE, na.last=TRUE)

#el valor de retorno de la funcion es el vector ordenado con las espeificaciones que le he dado en los argumentos
```

### üß© Ejercicio 3: primera funci√≥n

1.  Crea una funci√≥n que sirva para calcular el √°rea de habitaciones cuadradas o rectangulares. Para ello crea una funci√≥n de dos argumentos (el ancho de la habitaci√≥n y el largo) y que devuelva el √°rea.

    ```{r habitaciones, eval = FALSE}
    mi_funcion <- function(largo, ancho) {
      ancho * largo
    }
    ```

2.  Queremos saber el precio de enlosar la habitaci√≥n. Para ello a√±ade un tercer argumento con el precio por metro cuadrado.

    ```{r}
    mi_funcion <- function(largo, ancho, precio) {
      ancho * largo * precio
    }
    ```

3.  ¬øCuanto cuesta enlosar una habitaci√≥n de 10x16m con un tipo de losa que cuesta 5‚Ç¨ el metro cuadrado? ¬øY una de 32x4m con una que cuesta 16‚Ç¨ por metro cuadrado?

    ```{r}
    mi_funcion(10,16,5)
    mi_funcion(32,4,16)
    ```

### üß© Ejercicio 4: funcion de media aritm√©tica

Crea una funci√≥n que calcule la media aritm√©tica de los valores de un vector (sin usar la funci√≥n mean()). De tal manera que si introducimos, por ejemplo, el vector c(1, 8, 18) nos devuelva el valor 9

-   Pista1: sum() nos da el valor de la suma de los elementos de un vector \# prueba sum(c(1, 2, 3)) para comprobarlo

Pista 2: length() nos da la longitud (numero de elementos) del vector.

```{r}
mi_media<-function(v){
  sum(v)/length(v)
}

mi_media(c(10,5,2,14))
```

## Iteraciones con bucles for

### üß© Ejercicio 5: creando bucles for

Elige al menos una de las siguientes opciones y crea un bucle:

A partir del vector v\<- c(1,2,3,4), crea un vector w donde el pimer elemento de w sea el primer de v al cuadrado m√°s uno y as√≠ sucesivamente.

```{r}
v<- c(1,2,3,4)
w<-vector("integer", 4)

for (i in 1:length(v)){ #tambien i in 1:4; i in seq_along()
  w[[i]] = v[[i]]^2 +1
}
w
```

-   A partir de una lista con los dataframes de tidyverse msleep, diamonds y mpg, crea una nueva lista donde aparezcan esos mismos dataframes pero seleccionado solo las columnas que empiecen por "c" y las filas de la 10 a la 20.

```{r}
library(tidyverse)
lista_df<-list(msleep, diamonds, mpg)
lista_nueva<-list()

for (i in seq_along(lista_df)){
  lista_nueva[[i]]<-lista_df[[i]] |> select(starts_with("c")) |> slice(10:20)
}
```

-   Genera un bucle para leer los archivos df1 a df5 de la carpeta data/df y almacenarlos en una lista. Pista: consulta la funcion list.files() y mira cuidadosamente todos los argumentos.

```{r}
lista<-list.files("data/df", full.names=T)
lista_files<-list()

for (i in seq_along(lista)){
    lista_files[[i]]<- read_delim(lista[[i]])
}
```

## Iteraciones con funcionales

### üß© Ejercicio 6: map()

-   Genera un vector, una funci√≥n y aplica la funci√≥n a cada uno de los elementos del vector utilizando `map()`.

```{r}
v2<-c(5, 6, 8, 9, 11)
operacion<- function(x) sqrt(x*5)
map(v2, operacion)
```

-   para la lista list(a = 1:3, b = letters\[1:5\], c = c(TRUE, FALSE)) utiliza map() para generar una salida que sea una lista con las longitudes de cada elemento. ¬øQue funcion tendr√≠as que utilizar si quieres que la salida sea un vector de n√∫meros enteros en lugar de una lista?

```{r}
l1<- list(a = 1:3, b = letters[1:5], c = c(TRUE, FALSE))
map(l1, length)
map_int(l1, length)
```

-   para la lista_num \<- list(a = c(1,2,3), b = c(4,5), c = 6) aplica una funcion de la familia map para obtener la media de cada elemento a, b, c en un vector num√©rico.

```{r}
l2<-list(a = c(1,2,3), b = c(4,5), c = 6) 
map_dbl(l2, mean)

```

------------------------------------------------------------------------

<details>

<summary>Session Info</summary>

```{r session_info}
Sys.time()
sessionInfo()
```

</details>
